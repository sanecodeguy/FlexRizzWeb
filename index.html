<!DOCTYPE html>
<html>
<head>
  <title>NU Transcript Fetcher</title>
  <!-- Load CSS from your GitHub repo -->
  <link 
    rel="stylesheet" 
    href="https://cdn.jsdelivr.net/gh/sanecodeguy/FlexRizz@main/styles.css">
  
  <!-- Load utils.js and inject.js from GitHub -->
  <script src="https://cdn.jsdelivr.net/gh/sanecodeguy/FlexRizz@main/utils.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/sanecodeguy/FlexRizz@main/inject.js"></script>
  
  <style>
    body { 
      font-family: Arial, sans-serif; 
      max-width: 800px; 
      margin: 0 auto; 
      padding: 20px;
    }
    button {
      padding: 10px 15px;
      background: #0066cc;
      color: white;
      border: none;
      cursor: pointer;
    }
    #results {
      margin-top: 20px;
      padding: 15px;
      border: 1px solid #ddd;
    }
  </style>
</head>
<body>
  <h1>NU Transcript Generator</h1>
  <p>Click the button below to open FlexStudent. After logging in, your grades will appear here.</p>
  
  <button id="openPortal">Open FlexStudent Portal</button>
  <div id="results"></div>

  <!-- Custom logic -->
  <script>
    document.getElementById('openPortal').addEventListener('click', () => {
      // Open portal in a new tab
      const portal = window.open('https://flexstudent.nu.edu.pk/', '_blank');
      
      // Listen for grades from inject.js
      window.addEventListener('message', (event) => {
        if (event.data?.type === 'FLEXRIZZ_GRADES_DATA') {
          const grades = event.data.payload;
          displayGrades(grades);
        }
      });

      // Display grades in the results div
      function displayGrades(grades) {
        let html = '<h2>Your Transcript</h2><table>';
        html += '<tr><th>Course</th><th>Grade</th><th>Credits</th></tr>';
        
        grades.forEach(course => {
          html += `
            <tr>
              <td>${course.name || 'N/A'}</td>
              <td>${course.grade || 'N/A'}</td>
              <td>${course.credits || 'N/A'}</td>
            </tr>
          `;
        });
        
        html += '</table>';
        document.getElementById('results').innerHTML = html;
      }
    });
  </script>
</body>
</html>
